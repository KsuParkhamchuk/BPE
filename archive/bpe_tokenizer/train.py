from .tokenizer import BPETokenizer
from datasets import process_arrow, process_csv, process_scraped_text
from time import time

sample = "During childhood and adolescence, physiologic factors related to growth and development are in a constant state of evolution. Due to the progression of growth, it can be expected that healthy children will show noticeable gains in height, weight, maximal oxygen uptake, anaerobic capacity, and muscle strength during the developmental years (195). Although different children do not follow the same rates of change, performance variables such as grip strength normally increase from childhood through the early teenage years (148). Consequently, strength changes from low-volume (sets × repetitions × load), short-duration resistance training programs may not be distinguishable from gains due to normal growth and development (59,117). To differentiate training adaptations from those of normal growth and development, it is apparent that an adequate training stimulus and a prolonged training period are required. A compelling body of scientific evidence indicates that children and adolescents can significantly increase their strength-above and beyond growth and maturation-providing that the resistance training program is of sufficient intensity, volume, and duration (30,55,70,74,77,79,80,86-88,92,144,180,183,186,199,205,210,221,227,238,246,248,250). In addition, 2 meta-analyses on youth resistance training indicated mean effect sizes of 0.57 and 0.75 (94,179). Collectively, these findings along with clinical observations and evidence-based reviews (28,66,111,139,147,200,234) indicate that well-designed resistance training programs can enhance the muscular strength of children and adolescents beyond that which is normally due to growth and development. Children as young as 5 and 6 years have benefited from regular participation in a resistance training program (11,86,246), although most samples typically spanned several years (e.g., 7 to 12 years of age). While a majority of training studies had a duration of 8-20 weeks (79,80,92,118,144,186,205,210,246), studies lasting 2-3 school years have been reported (93,198). A wide variety of resistance training programs from single set sessions on weight machines (249) to progressive, multi-set training protocols on different types of equipment (22,74,105,186,198,238) have proven to be efficacious. Training modalities have included weight machines (both adult (55,180,238,239) and child size (79,80,86,183,249)), free weights (22,55,74,94,105,198,199), hydraulic machines (30,246), pneumatic machines (205), medicine balls (77,221); elastic bands (11), isometric contractions (101,117,174), and body weight exercises (17,92,210,236). As previously observed in adult populations, training adaptations that occur in youth are specific to the muscle action or muscle groups that are trained (97,174). Strength gains up to 74% (88) have been reported after 8 weeks of progressive resistance training, although gains of roughly 30% are typically observed after short-term (8-20 weeks) youth resistance training programs. Reported relative (% change above initial levels) strength gains achieved during preadolescence are equal to if not greater than the relative gains observed during adolescence (144,174,180,248). Adult athletes tend to be stronger than adolescent athletes (14), and there is no clear evidence of any major difference in strength between preadolescent boys and girls (27,81,200). In terms of absolute strength gains, it appears that adolescents make greater gains than children (144,200,239) and adults make greater gains than young adolescents (199), although some findings are at variance with this suggestion (248). Persistence of Training-Induced Strength Gains The evaluation of strength changes in youth after the temporary or permanent reduction or withdrawal of a training stimulus (referred to as detraining) is complicated by the concomitant growth-related strength increases during the same period. Although relative information regarding the effects of detraining on younger populations is not extensive, the available data suggest that training-induced gains in strength and power in children are impermanent and tend to regress toward untrained control group values during the detraining period (29,87,125,205,227). The precise nature of the detraining response and the physiological adaptations that occur during this period remain uncertain, although changes in neuromuscular functioning and the hormonal responses to resistance training and detraining should be considered. Of interest, researchers found that training-induced increases in the levels of testosterone and free androgen index in children were maintained during an 8-week detraining period despite the regression of strength toward untrained control group values during this phase of the study (226,227). Only a limited number of studies have evaluated the effects of training frequency on the maintenance of strength and power in children and adolescents. After 20 weeks of progressive resistance training, a once-weekly maintenance training program was not adequate to maintain the training-induced strength gains in preadolescent males (29). Conversely, a once-weekly maintenance program was just as sufficient as a twice-weekly maintenance program in retaining the strength gains made after 12 weeks of resistance training in a group of adolescent male athletes (55). Others observed that children who participated in a 10-week plyometric training program were able to maintain training-induced gains in power after 8 weeks of reduced training, which included soccer practice (56). Clearly, more research is needed before specific maintenance training recommendations can be made. Program Evaluation and Testing Factors such as previous exercise experience, program design, specificity of testing and training, choice of equipment, quality of instruction, and whether or not the learning effect was controlled for in the study can directly influence the degree of measured strength change. In addition, the methods of evaluating changes in muscular strength consequent to training are noteworthy considerations. In some studies, the subjects were trained and tested using different modalities (180,205,246), and in other published reports, strength changes were evaluated by relatively high RM values (e.g., 10RM) (74,88,144,248). Strength changes have also been evaluated by maximal load lifting (e.g., 1RM) on the equipment used in training (22,55,79,80,118,178,183,186,198,238). Some clinicians and researchers have not used 1RM testing to evaluate training-induced changes in muscular strength because of the presumption that high-intensity loading may cause structural damage in children. Thus, the maximal force production capabilities of children have not been directly evaluated in some studies. Yet no injuries have been reported in prospective studies that utilized adequate warm-up periods, appropriate progression of loads, close and qualified supervision, and critically chosen maximal strength tests (1RM performance lifts, maximal isometric tests, and maximal isokinetic tests) to evaluate resistance training-induced changes in children. In a study, 96 children performed a 1RM strength test on 1 upper-body and 1 lower-body weight machine exercise (81). No abnormal responses or injuries occurred during the study period, and the testing protocol was reportedly well tolerated by the subjects. In other reports, children and adolescents safely performed 1RM strength tests using free weight exercises (14,22,118,124,142,152,153,178,198,238). Paradoxically, most of the forces that youth are exposed to in various sports and recreational activities are likely to be greater in both exposure time and magnitude than competently supervised and properly performed maximal strength tests. These observations along with current research findings indicate that the maximal force-producing capabilities of healthy children and adolescents can be safely evaluated by 1RM testing procedures, provided that youth participate in an habituation period before testing to learn proper exercise technique and qualified professionals closely supervise and administer each test. Detailed procedures for evaluating 1RM strength are available elsewhere (81,140). Although maximal strength testing can be used to evaluate training-induced changes in muscular strength in children and adolescents in clinical and recreational settings, when properly administered 1RM tests are labor intensive and time consuming. Thus, in some instances (e.g., physical education class) the use of field-based measures may be more appropriate and time efficient. Researchers have documented significant correlations between 1RM strength and common field measures (e.g., handgrip strength and long jump) in children (164). In any case, unsupervised and improper 1RM testing (e.g., inadequate progression of loading and poor lifting technique) should not be performed by children or adolescents under any circumstances due to the real risk of injury (189,190). Physiological Mechanisms for Strength Development In children it appears that training-induced strength gains are more related to neural mechanisms than to hypertrophic factors (139,147,178,186,200). Without adequate levels of circulating testosterone to stimulate increases in muscle size, children appear to experience more difficulty increasing their muscle mass consequent to a resistance training program (up to 20 weeks) as compared with older populations (178,186,239). However, because some findings are at variance with this suggestion (100,158), it cannot be stated a priori that resistance training will not increase the muscle mass of prepubescent youth. It is possible that more intensive training programs, longer training durations, and more sensitive measuring techniques that are ethically appropriate for this population may be needed to partition the effects of training on fat free mass from expected gains due to growth and maturation. Without corresponding increases in fat-free mass, it appears that neural adaptations (i.e., a trend toward increased motor unit activation and changes in motor unit coordination, recruitment, and firing) (178,186) and possibly intrinsic muscle adaptations (as evidenced by increases in twitch torque) (186) are primarily responsible for training-induced strength gains during preadolescence. Improvements in motor skill performance and the coordination of the involved muscle groups may also play a significant role because measured increases in training-induced strength are typically greater than changes in neuromuscular activation (178,186). Although speculative, developmental alterations in muscle fiber architecture (e.g., pennation angle) and changes in central inhibitory influences on maximal muscle strength should also be considered (195). In support of these observations, several training studies have reported significant improvements in strength during preadolescence without corresponding increases in gross limb morphology, as compared with a similar control group (88,144,178,186,199,246). During puberty, testicular testosterone secretion in males is associated with considerable increases in fat-free mass and linear growth (139,195). Training-induced strength gains during and after puberty in males may therefore be associated with changes in hypertrophic factors because testosterone and other hormonal influences on muscle hypertrophy would be operant (139). Smaller amounts of testosterone in females (resulting from enzymatic conversion of androgenic precursors in the adrenal gland) limit the magnitude of training-induced increases in muscle hypertrophy (195,200). Other hormone and growth factors (e.g., growth hormone and insulin-like growth factors) may be at least partly responsible for muscle development in females (135). Potential Health and Fitness Benefits There are many health and fitness benefits associated with regular physical activity in children and adolescents. Not only is habitual physical activity essential for normal growth and development, but also participation in age-appropriate fitness programs can enhance the physical and psychosocial well-being of youth. Although a majority of the pediatric research has focused on activities that enhance cardiorespiratory fitness (195), recent findings indicate that resistance training can offer unique benefits for children and adolescents when appropriately prescribed and supervised. As previously observed in adults (97), regular participation in a resistance training program has the potential to positively influence several measurable indices of health and fitness. Youth resistance training can improve one's cardiovascular risk profile, facilitate weight control, strengthen bone, enhance psychosocial well-being, improve motor performance skills, and increase a young athletes' resistance to sports-related injuries. Research that supports the utility of youth resistance training in the acquisition of favorable degrees of health-associated characteristics is expanding (67,147,219). Moreover, the contention that the overall health of children and adolescents is likely to improve rather than be adversely affected by regular participation in a resistance training program is supported by statements from professional organizations (8,18,33,167,192). Although good health habits established during childhood do not always carry over into adulthood, the potential positive influence of these habits on the adult lifestyle should be recognized (146,196,222,225). Hence, a compelling reason to encourage children and adolescents to participate regularly in physical activity is to reduce their risk of developing adult diseases later in life. Cardiovascular Risk Profile The potential influence of resistance training on body composition (the percentage of total body weight that is fat compared with the percentage that is fat free) has become an important topic of investigation, given that the prevalence of obesity among children and adolescents continues to increase worldwide (175,240). Today, childhood obesity, with its associated comorbidities such as type 2 diabetes and likelihood of persistence into adulthood, is a critical public health threat (126). Although genetic, psychosocial, economic, and environmental factors likely play a role in the development of obesity during childhood and adolescence (4,62), it is becoming more apparent that the increasing prevalence of obesity among school-aged youth may be due, at least in part, to a sedentary lifestyle (62,106). Although obese youth have traditionally been encouraged to participate in aerobic activities, excess body weight hinders the performance of weight-bearing physical activities such as jogging and increases the risk of musculoskeletal overuse injuries. Furthermore, obese youth often lack the motor skills and confidence to be physically active, and they may actually perceive prolonged periods of aerobic exercise to be boring or discomforting. In support of these observations, it has been reported that total body fat was inversely related to minutes of vigorous physical activity per day in youth (54). Others observed that this decline in physical activity may start early in life in obese youth (103). Recently, it has been suggested that resistance training may offer observable health value to obese children and adolescents (23,83,243). Obese youth tend to enjoy resistance training because it is typically characterized by short periods of physical activity interspersed with brief rest periods between sets and exercises, which is more consistent with how youth move and play (13,106). Several studies have reported favorable changes in body composition in children and adolescents who were obese or at risk for obesity after participation in a resistance training program or a circuit weight training (i.e., combined resistance and aerobic training) program (24,203,206,214,220,224,242,254). In a report, the level of adiposity in school-aged youth was a strong negative predictor of the resistance training effect in the lower limbs (93). Thus, obese youth may need a higher relative training intensity to produce the desired effect. Of interest, researchers found that participation in a 16-week resistance training program significantly decreased body fat and significantly increased insulin sensitivity in adolescent males who were at risk for obesity (206). Because the increase in insulin sensitively remained significant after adjustment for changes in total fat mass and total lean mass, it appeared that regular resistance training may have resulted in qualitative changes in skeletal muscle that contributed to enhanced insulin action. Compliance to this program was impressive with 96% of the participants completing the program. Other researchers identified muscular strength as an independent and powerful predictor of better insulin sensitivity in youth aged 10-15 years (21). Because resistance training may provide a more enjoyable and sustainable approach to health-related physical activity promotion in children and adolescents who are obese or at risk for obesity, additional randomized controlled trials are needed to further examine the effects of resistance training on metabolic health outcomes in youth. At present, there is no clear association between regular physical activity and reducing blood pressure in normotensive youth, although limited data suggest that resistance training may be an effective nonpharmacologic intervention in hypertensive adolescents, provided that submaximal loads are used and proper exercise procedures are followed (112). Others have recommended low-intensity, high-repetition resistance training for hypertensive adolescents who want to experience this type of training (256). Although the acute blood pressure response to resistance exercise is reportedly similar between children and adults (172), blackouts (loss of consciousness) and chronic hypertension, which have been reported in adult competitive weightlifters (49), have not been reported in children (88,187) or adolescents (112) after resistance training. The effects of resistance training on blood lipoproteins in youth are not well documented. Limited data suggest that when compared with an inactive control group, resistance training characterized by moderate loads and a high number of repetitions can have a positive influence on the blood lipid profile of children (220,247), and similar trends have been observed in adolescents (98). Because changes in body composition and nutritional intake may influence lipoprotein concentrations in youth, a comprehensive health-enhancing program that includes regular physical activity, behavioral counseling, and nutrition education may be most effective for improving the blood lipid profile in youth with dyslipidemia (7)."

sample2 = "2 pounds skinless, boneless chicken breast halves 2 teaspoons salt ½ cup cooking oil 1 ½ cups chopped onion 1 tablespoon minced garlic 1 ½ teaspoons minced fresh ginger root 1 tablespoon curry powder 1 teaspoon ground cumin 1 teaspoon ground turmeric 1 teaspoon ground coriander 1 teaspoon cayenne pepper 1 tablespoon water 1 (15 ounce) can crushed tomatoes 1 cup plain yogurt 1 tablespoon chopped fresh cilantro 1 teaspoon salt ½ cup water 1 teaspoon garam masala 1 tablespoon chopped fresh cilantro 1 tablespoon fresh lemon juice Local Offers Change Directions Gather all ingredients. Ingredients for Indian Chicken Curry (Murgh Kari) recipe Dotdash Meredith Food Studios Sprinkle the chicken breasts with 2 teaspoons salt. Heat oil in a large skillet over high heat; partially cook the chicken in the hot oil in batches until completely browned on all sides. Transfer browned chicken breasts to a plate and set aside. Chicken breasts cooking in hot oil in a skillet Dotdash Meredith Food Studios Reduce the heat to medium and add onion, garlic, and ginger to the oil remaining in the skillet. Cook and stir until onion turns soft and translucent, 5 to 8 minutes. Stir curry powder, cumin, turmeric, coriander, cayenne, and 1 tablespoon of water into the onion mixture; allow to heat together for about 1 minute while stirring. Onion, garlic, ginger curry powder, cumin, turmeric, coriander, cayenne, and water cooking in a skillet Dotdash Meredith Food Studios Add tomatoes, yogurt, 1 tablespoon chopped cilantro, and 1 teaspoon salt to the mixture; stir to combine. Sauce for Indian Chicken Curry cooking in a skillet Dotdash Meredith Food Studios Return chicken breast to the skillet along with any juices on the plate. Pour in 1/2 cup water and bring to a boil, turning the chicken to coat with the sauce. Sprinkle garam masala and 1 tablespoon cilantro over the chicken. Indian Chicken Curry cooking in a skillet Dotdash Meredith Food Studios Cover the skillet and simmer until chicken breasts are no longer pink in the center and the juices run clear, about 20 minutes. An instant-read thermometer inserted into the center should read at least 165 degrees F (74 degrees C). Drizzle with lemon juice to serve. You'll find a detailed ingredient list and step-by-step instructions in the recipe below, but let's go over the basics: Tinga Ingredients These are the ingredients you’ll need to make this homemade chicken tinga recipe: Onion and oil: This chicken tinga recipe starts with a large diced onion cooked in olive oil. Canned goods: You’ll need a can of stewed tomatoes and a can of chipotle peppers in adobo sauce. Chicken: Cook and shred your own chicken or use leftover rotisserie chicken for this tinga recipe. Tostada shells: Serve the flavorful chicken tinga over tostada shells. Sour cream: Finish each serving with a dollop of sour cream. How to Make Chicken Tinga Here’s a brief overview of what you can expect when you make chicken tinga: Cook the onion. Purée the tomatoes and chipotle peppers in a blender. Add the purée to the onions on the stove, stir in the chicken, and simmer. Dollop the chicken mixture onto tostadas and top with sour cream. What to Serve With Tinga Need some serving inspiration? You’ll discover delicious ideas when you explore our entire collection of Mexican Side Dishes. Here are a few of the top-rated recipes you’ll find: Mexican Rice Quick and Easy Refried Beans Mexican Corn on the Cob (Elote) How to Store Tinga Store the chicken tinga in an airtight container in an airtight container in the refrigerator for up to five days. Reheat on the stove, in the oven, or in the microwave. Allrecipes Community Tips and Praise “Amazing,” raves NenaSkyye. “I add more cans of chipotle in adobo sauce and it comes out great. I also season my onions while they sauté with Adobo red cap seasoning.” “I love it,” says Robert Walsh. “A little bit on the spicy side, but I like it that way. Kids love it. Quick dish to make with only a few ingredients. I used leftover rotisserie chicken in mine.” “This is wonderful with just the right amount of heat,” according to Kimberly K. “I use this tinga for making lettuce wraps. I top the lettuce with the tinga, bean sprouts, shredded carrots and chia seeds.” Editorial contributions by Corey Williams Cook Mode (Keep screen awake) Ingredients 1x 2x 4x Original recipe (1X) yields 8 servings 2 tablespoons olive oil 1 large onion, diced 1 (15 ounce) can stewed tomatoes 1 (7 ounce) can chipotle peppers in adobo sauce, or to taste 2 pounds shredded cooked chicken meat 16 tostada shells ½ cup sour cream Directions Heat oil in a saucepan over medium heat. Add onions and sauté until softened and translucent, about 5 minutes. Meanwhile, purée stewed tomatoes and chipotle peppers in adobo sauce in a blender. Pour puréed mixture over onions in the saucepan; add chicken and stir to combine. Cover and simmer for 20 minutes. Mound chicken mixture onto tostada shells and garnish with sour cream."


def train_general():
    general_tokenizer = BPETokenizer("general")
    preprocessed_data = process_arrow(8, "datasets/wikitext/train1.arrow")
    general_tokenizer.train(preprocessed_data)


def train_domain_specific():
    domain_specific_tokenizer = BPETokenizer("domain")
    recipengl_data = process_csv()
    pubmed_data = process_scraped_text()
    combined_data = recipengl_data + pubmed_data
    domain_specific_tokenizer.train(combined_data)


def __main__():
    start = time()
    train_domain_specific()
    print(f"Training took: {time()-start:.2f} seconds")


__main__()
